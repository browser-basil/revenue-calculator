<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Revenue Calculator</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body {
  font-family: 'Inter', sans-serif;
  background: linear-gradient(135deg, #dbeafe, #f8fafc);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px;
}
.card {
  background-color: white;
  border-radius: 1rem;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  width: 100%;
  max-width: 700px;
  position: relative;
}
.suggestions {
  position: absolute;
  z-index: 10;
  width: 100%;
  background: white;
  border: 1px solid #d1d5db;
  border-radius: 0.5rem;
  margin-top: 0.25rem;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
  max-height: 200px;
  overflow-y: auto;
}
.suggestion-item {
  padding: 0.5rem 1rem;
  cursor: pointer;
}
.suggestion-item:hover {
  background-color: #eff6ff;
}
.history-table th, .history-table td {
  padding: 0.5rem;
  border-bottom: 1px solid #d1d5db;
  text-align: center;
}
@media(max-width:640px){
  .history-table th, .history-table td { font-size: 0.75rem; padding: 0.25rem; }
}
.value-line {
  display: block;
  margin-top: 0.25rem;
}
</style>
</head>
<body>
<div class="card">
  <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">üè® Revenue Calculator</h1>

  <div class="space-y-4 relative">
    <!-- Land Cost -->
    <div class="relative">
      <label class="block font-medium mb-1">Land Cost (‚Çπ)</label>
      <input type="text" id="landCost" class="cost-input w-full border rounded-lg p-2" placeholder="Enter Land Cost" autocomplete="off" />
      <div id="landCost-suggestions" class="suggestions hidden"></div>
    </div>
    <!-- Construction Cost -->
    <div class="relative">
      <label class="block font-medium mb-1">Construction Cost (‚Çπ)</label>
      <input type="text" id="constructionCost" class="cost-input w-full border rounded-lg p-2" placeholder="Enter Construction Cost" autocomplete="off" />
      <div id="constructionCost-suggestions" class="suggestions hidden"></div>
    </div>
    <!-- Miscellaneous Cost -->
    <div class="relative">
      <label class="block font-medium mb-1">Miscellaneous Cost (‚Çπ)</label>
      <input type="text" id="miscCost" class="cost-input w-full border rounded-lg p-2" placeholder="Enter Miscellaneous Cost" autocomplete="off" />
      <div id="miscCost-suggestions" class="suggestions hidden"></div>
    </div>
    <!-- Number of Rooms -->
    <div>
      <label class="block font-medium mb-1">Number of Rooms</label>
      <input type="number" id="numRooms" class="w-full border rounded-lg p-2" placeholder="Enter Number of Rooms" />
    </div>
    <!-- Average Room Rate -->
    <div>
      <label class="block font-medium mb-1">Average Room Rate (‚Çπ)</label>
      <input type="text" id="avgRoomRate" class="w-full border rounded-lg p-2" placeholder="Enter Average Room Rate" />
    </div>
    <!-- Occupancy Days -->
    <div>
      <label class="block font-medium mb-1">Occupancy Days / Month</label>
      <input type="number" id="occupancyDays" class="w-full border rounded-lg p-2" placeholder="Enter Occupancy Days" />
    </div>
  </div>

  <div class="space-y-3 text-lg mt-6">
    <div>
      <strong>Total Capex:</strong>
      <span id="totalCapex" class="font-semibold text-blue-700 value-line">‚Çπ0.00</span>
    </div>
    <div>
      <strong>Monthly Expenses:</strong>
      <span id="monthlyExpenses" class="font-semibold text-red-600 value-line">‚Çπ0.00</span>
    </div>
    <div>
      <strong>Monthly Profit after Expenses:</strong>
      <span id="netIncome" class="font-semibold text-green-700 value-line">‚Çπ0.00</span>
    </div>
    <div>
      <strong>ROI (Annual):</strong> <span id="roi" class="font-semibold text-indigo-700">0.00%</span>
    </div>
  </div>


  <button id="moveHistory" class="mt-4 w-full bg-gray-400 cursor-not-allowed text-white p-2 rounded-lg font-semibold" disabled>
    Move to History
  </button>


  <hr class="my-4" />

  <div class="mt-6">
    <div class="flex justify-between items-center mb-2">
      <h2 class="text-xl font-bold text-gray-700">Calculation History</h2>
      <button id="clearHistory" class="bg-red-600 hover:bg-red-700 text-white p-1 rounded-md text-sm">Clear History</button>
    </div>
    <div class="overflow-x-auto">
      <table class="w-full history-table text-sm min-w-[600px]">
        <thead>
          <tr>
            <th>Capex</th>
            <th>Rooms</th>
            <th>Occupancy</th>
            <th>Expense</th>
            <th>Profit</th>
            <th>ROI</th>
          </tr>
        </thead>
        <tbody id="historyBody"></tbody>
      </table>
    </div>
  </div>
</div>

<script>
const totalCapexEl = document.getElementById('totalCapex');
const netIncomeEl = document.getElementById('netIncome');
const roiEl = document.getElementById('roi');
const monthlyExpensesEl = document.getElementById('monthlyExpenses');
const costInputs = document.querySelectorAll('.cost-input');
const otherInputs = ['numRooms','avgRoomRate','occupancyDays'].map(id=>document.getElementById(id));
const historyBody = document.getElementById('historyBody');
const moveHistoryBtn = document.getElementById('moveHistory');
const clearHistoryBtn = document.getElementById('clearHistory');

function formatCurrency(value){
  return '‚Çπ'+Number(value||0).toLocaleString('en-IN',{minimumFractionDigits:2, maximumFractionDigits:2});
}
function formatPercent(value){
  return Number(value||0).toFixed(2)+'%';
}
function parseCostInput(el){
  if(el.dataset.value) return parseFloat(el.dataset.value);
  const raw = el.value.replace(/,/g,'').match(/[\d\.]+/);
  if(!raw) return 0;
  return parseFloat(raw[0])*100000;
}
function convertToLakhCr(value){
  if(value>=10000000) return (value/10000000).toFixed(2)+' Cr ('+formatCurrency(value)+')';
  else if(value>=100000) return (value/100000).toFixed(2)+' Lakh ('+formatCurrency(value)+')';
  else return formatCurrency(value);
}

function calculate() {
  const landCost = parseCostInput(document.getElementById('landCost'));
  const constructionCost = parseCostInput(document.getElementById('constructionCost'));
  const miscCost = parseCostInput(document.getElementById('miscCost'));
  const numRooms = parseFloat(document.getElementById('numRooms').value) || 0;
  const avgRoomRate = parseFloat(document.getElementById('avgRoomRate').dataset.value) || 0;
  const occupancyDays = parseFloat(document.getElementById('occupancyDays').value) || 0;

  const totalCapex = landCost + constructionCost + miscCost;
  totalCapexEl.textContent = convertToLakhCr(totalCapex);

  // Enable or disable Move to History button
  if (totalCapex > 0) {
    moveHistoryBtn.disabled = false;
    moveHistoryBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
    moveHistoryBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
  } else {
    moveHistoryBtn.disabled = true;
    moveHistoryBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
    moveHistoryBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
  }

  const monthlyIncome = avgRoomRate * occupancyDays * numRooms;
  const monthlyExpenses = (numRooms > 0 ? 50000 : 0) + (10000 * numRooms);
  document.getElementById('monthlyExpenses').textContent = convertToLakhCr(monthlyExpenses);

  if (monthlyIncome > 0) {
    const profit = monthlyIncome - monthlyExpenses;
    const roi = totalCapex > 0 ? (profit * 12 / totalCapex) * 100 : 0;
    netIncomeEl.textContent = convertToLakhCr(profit);
    roiEl.textContent = formatPercent(roi);
  } else {
    netIncomeEl.textContent = convertToLakhCr(0);
    roiEl.textContent = '0.00%';
  }
}

// Auto-select all fields
document.querySelectorAll('input').forEach(input=>input.addEventListener('focus',e=>e.target.select()));

// Average Room Rate formatting
const avgRoomRateEl=document.getElementById('avgRoomRate');
avgRoomRateEl.addEventListener('input', e => {
  const raw = e.target.value.replace(/[^0-9]/g,'');
  const value = parseFloat(raw) || 0;
  e.target.dataset.value = value;
  e.target.value = raw ? '‚Çπ' + value.toLocaleString('en-IN') : '';
  calculate();
});

// Crore/Lakh suggestions
function generateSuggestions(inputEl,value){
  const box=document.getElementById(inputEl.id+'-suggestions');
  box.innerHTML='';
  box.classList.add('hidden');
  if(!value||inputEl.dataset.value) return;
  const num=parseFloat(value);
  if(isNaN(num)) return;
  const suggestions=[
    {label:num+' Cr ('+formatCurrency(num*10000000)+')', value:num*10000000},
    {label:num+' Lakh ('+formatCurrency(num*100000)+')', value:num*100000}
  ];
  suggestions.forEach(s=>{
    const div=document.createElement('div');
    div.classList.add('suggestion-item');
    div.textContent=s.label;
    div.onclick=()=>{ inputEl.value=s.label; inputEl.dataset.value=s.value; box.classList.add('hidden'); calculate();}
    box.appendChild(div);
  });
  box.classList.remove('hidden');
}

costInputs.forEach(input=>{
  input.addEventListener('input',e=>{
    delete e.target.dataset.value;
    generateSuggestions(e.target, e.target.value.replace(/[^\d\.]/g,''));
    calculate();
  });
  input.addEventListener('focus',e=>generateSuggestions(e.target, e.target.value.replace(/[^\d\.]/g,'')));
});

document.addEventListener('click', e=>{
  document.querySelectorAll('.suggestions').forEach(box=>{
    if(!box.contains(e.target) && !box.previousElementSibling.contains(e.target)) box.classList.add('hidden');
  });
});

[...costInputs,...otherInputs].forEach(input=>input.addEventListener('input', calculate));

// Move to History
moveHistoryBtn.addEventListener('click', () => {
  const landCost = parseCostInput(document.getElementById('landCost'));
  const constructionCost = parseCostInput(document.getElementById('constructionCost'));
  const miscCost = parseCostInput(document.getElementById('miscCost'));
  const numRooms = parseInt(document.getElementById('numRooms').value) || 0;
  const avgRoomRate = parseFloat(document.getElementById('avgRoomRate').dataset.value) || 0;
  const occupancyDays = parseInt(document.getElementById('occupancyDays').value) || 0;

  const totalCapex = landCost + constructionCost + miscCost;
  if (totalCapex <= 0) return; // prevent empty/zero entries

  const monthlyIncome = avgRoomRate * occupancyDays * numRooms;
  const monthlyExpenses = numRooms > 0 ? 50000 + 10000 * numRooms : 0;
  const monthlyProfit = monthlyIncome > 0 ? monthlyIncome - monthlyExpenses : 0;
  const roi = monthlyIncome > 0 && totalCapex > 0 ? (monthlyProfit * 12 / totalCapex) * 100 : 0;

  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>${convertToLakhCrOnly(totalCapex)}</td>
    <td>${numRooms}</td>
    <td>${occupancyDays}</td>
    <td>${convertToLakhCrOnly(monthlyExpenses)}</td>
    <td>${convertToLakhCrOnly(monthlyProfit)}</td>
    <td>${formatPercent(roi)}</td>
  `;
  historyBody.appendChild(tr);
});

// Helper to convert numbers to Lakh/Cr ONLY
function convertToLakhCrOnly(value){
  if(value >= 10000000){
    // divide by 1 Cr = 1,00,00,000, format with Indian commas
    const crValue = value / 10000000;
    return crValue.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' Cr';
  } 
  if(value >= 100000){
    // divide by 1 Lakh = 1,00,000
    const lakhValue = value / 100000;
    return lakhValue.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' Lakh';
  } 
  // less than 1 Lakh, just Indian commas
  return value.toLocaleString('en-IN', { maximumFractionDigits: 0 });
}

// Clear History
clearHistoryBtn.addEventListener('click',()=>{ historyBody.innerHTML=''; });

</script>
</body>
</html>

